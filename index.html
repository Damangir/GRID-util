<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Grid-util by Damangir</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1 class="header">Grid-util</h1>
        <p class="header">Utility script for work with the N4U Grid.</p>

        <ul>
          <li class="download"><a class="buttons" href="https://github.com/Damangir/GRID-util/zipball/master">Download ZIP</a></li>
          <li class="download"><a class="buttons" href="https://github.com/Damangir/GRID-util/tarball/master">Download TAR</a></li>
          <li><a class="buttons github" href="https://github.com/Damangir/GRID-util">View On GitHub</a></li>
        </ul>

        <p class="header">This project is maintained by <a class="header name" href="https://github.com/Damangir">Damangir</a></p>


      </header>
      <section>
        <h1>
<a name="grid-util-utility-script-for-work-with-the-n4u-grid" class="anchor" href="#grid-util-utility-script-for-work-with-the-n4u-grid"><span class="octicon octicon-link"></span></a>GRID-util: Utility script for work with the N4U Grid</h1>

<h2>
<a name="table-of-content" class="anchor" href="#table-of-content"><span class="octicon octicon-link"></span></a>Table of Content</h2>

<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#installation">Installation</a></li>
<li>
<a href="#manual">Manual</a>

<ul>
<li><a href="#copy-files-tofrom-storage-element">Copy files between user interface and storage element back and forth</a></li>
<li><a href="#create-a-job-file-automatically">Automatic jobfile creation</a></li>
</ul>
</li>
<li><a href="#copyright">Copyright</a></li>
<li><a href="#license">License</a></li>
</ul><h2>
<a name="introduction" class="anchor" href="#introduction"><span class="octicon octicon-link"></span></a>Introduction</h2>

<p>Grid-util is a set of tool to facilitate working with the <a href="https://neugrid4you.eu/">N4U grid</a> in the command-line mode.</p>

<p><strong>Grid-util is NOT endorsed by the <a href="https://neugrid4you.eu/partners">N4U Consortium</a>.</strong></p>

<h2>
<a name="installation" class="anchor" href="#installation"><span class="octicon octicon-link"></span></a>Installation</h2>

<p>Download the package using <code>curl</code></p>

<div class="highlight highlight-bash"><pre>curl -O https://github.com/Damangir/GRID-util/archive/master.zip
</pre></div>

<p>or using <code>wget</code></p>

<div class="highlight highlight-bash"><pre>wget https://github.com/Damangir/GRID-util/archive/master.zip
</pre></div>

<p>Then decopmress the files.</p>

<div class="highlight highlight-bash"><pre>unzip master.zip
</pre></div>

<p>If you have administrative right install using:</p>

<div class="highlight highlight-bash"><pre>sudo su
. GRID-util-master/install.sh
</pre></div>

<p>otherwise use:</p>

<div class="highlight highlight-bash"><pre>. GRID-util-master/install.sh
</pre></div>

<p>Now you can check installation by:</p>

<div class="highlight highlight-bash"><pre>grid-copy.sh -h
</pre></div>

<p>If you install in admin mode and ever want to uninstall GRID-util you can do so by:</p>

<div class="highlight highlight-bash"><pre>sudo su -
uninstall-GRID-util
</pre></div>

<h2>
<a name="manual" class="anchor" href="#manual"><span class="octicon octicon-link"></span></a>Manual</h2>

<h3>
<a name="copy-files-tofrom-storage-element" class="anchor" href="#copy-files-tofrom-storage-element"><span class="octicon octicon-link"></span></a>Copy files to/from storage element</h3>

<p>You can use <code>grid-copy.sh</code> to copy batch files between user interface and storage elemet back and forth.</p>

<pre><code>usage: grid-copy.sh options

Copies batch of files back and forth to the grid.

OPTIONS:
   -l      Local directory (in interface, e.g. ~/MyShares/n4u/to-process)
   -g      Grid directory  (in the grid)
   -p      Pattern for files to be copied (default *.nii.gz)

   -d      Download images from the GRID
   -u      Upload images to the GRID (default)
   -r      Retry count on copy failure (default 5)

   -f      Run from fail file generated with previous runs. This option will 
           supress all other options.

   -h      Show this message
</code></pre>

<p>For example in order to copy all <code>nii.gz</code> files from <code>~/MyShares/to-process</code> folder in user interface to <code>$PANDORA_GRID_HOME/input</code> storage element you can use:</p>

<div class="highlight highlight-bash"><pre>grid-copy.sh -l ~/MyShares/to-process -g <span class="nv">$PANDORA_GRID_HOME</span>/input -p <span class="s2">"*.nii.gz"</span> -u
</pre></div>

<p>After you process data, suppose the your output is in <code>$PANDORA_GRID_HOME/output</code> and is in <code>tar.bz</code> format. To bring them back to <code>~/MyShares/processed</code> you can use:</p>

<div class="highlight highlight-bash"><pre>grid-copy.sh -g <span class="nv">$PANDORA_GRID_HOME</span>/output -l ~/MyShares/processed -p <span class="s2">"*.tar.bz"</span> -d
</pre></div>

<p>The <code>grid-copy.sh</code> will produce a file called <code>copy_fail</code>. If any copy failed you will be notified with a note like:</p>

<pre><code>There is/are 1 failing(s) in the batch process. The failing processes are written in copy_fail_131122_175431.sh.                                                                                                                                        
You can re-run them using gridcopy.sh -f copy_fail_131122_175431.sh
</code></pre>

<p>As adviced in the note you can re-run failed copies using:</p>

<div class="highlight highlight-bash"><pre>grid-copy.sh -f copy_fail_131122_175431.sh
</pre></div>

<p>The digits at the end the file name means its for the copying on 22 November 2013 17:54:31. If you have many <code>copy_fail</code> files, make sure you are using the one you intend to use.</p>

<h3>
<a name="create-a-job-file-automatically" class="anchor" href="#create-a-job-file-automatically"><span class="octicon octicon-link"></span></a>Create a job file automatically</h3>

<p>You can use <code>grid-jobfile.sh</code> to create a <a href="https://neugrid4you.eu/group/science-gateway/knowledge-base/-/wiki/Main/Express+Lane">jobfile</a> when you want to run jobs with <code>inputDir</code> located in the grid storage elements (<code>lfn:</code>).</p>

<pre><code>usage: grid-jobfile.sh OPTIONS

Creates job file for files in a directory.

OPTIONS:
   -g      Grid directory  (in the grid)
   -p      Pattern for files to be added to jobfile (default *.nii.gz)
   -o      Output Jobfile (default only prints it)
   -r      Retry count on copy failure (default 5)

   -h      Show this message
</code></pre>

<h2>
<a name="copyright" class="anchor" href="#copyright"><span class="octicon octicon-link"></span></a>Copyright</h2>

<p>Copyright (C) 2013 <a href="http://www.linkedin.com/in/soheildamangir">Soheil Damangir</a> - All Rights Reserved</p>

<h2>
<a name="license" class="anchor" href="#license"><span class="octicon octicon-link"></span></a>License</h2>

<p><a href="http://creativecommons.org/licenses/by-nc-sa/3.0/"><img src="https://raw.github.com/Damangir/GRID-util/master/licence.png" alt="Creative Commons Attribution-NonCommercial-ShareAlike 3.0 Unported License" title="Creative Commons Attribution-NonCommercial-ShareAlike 3.0 Unported License"></a></p>

<p>GRID-util by <a href="http://www.linkedin.com/in/soheildamangir">Soheil Damangir</a> is licensed under a <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/">Creative Commons Attribution-NonCommercial-ShareAlike 3.0 Unported License</a>. To view a copy of this license, visit <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/">http://creativecommons.org/licenses/by-nc-sa/3.0/</a>.</p>
      </section>
      <footer>
        <p><small>Hosted on <a href="http://pages.github.com">GitHub Pages</a> using the Dinky theme</small></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
		
  </body>
</html>
